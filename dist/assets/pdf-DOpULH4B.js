import{j as q,E as tt}from"./jspdf.es.min-BgNKXESA.js";import{a8 as et,ae as Z}from"./index-BCVF1PLb.js";import{f as K,d as X}from"./de-B2K29ify.js";var nt={exports:{}};const rt=et(q);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(O,$){(function(H,I){O.exports=I(function(){try{return rt}catch{}}())})(typeof globalThis<"u"?globalThis:typeof Z<"u"?Z:typeof window<"u"?window:typeof self<"u"?self:Z,function(B){return function(){var H={172:function(A,m){var C=this&&this.__extends||function(){var c=function(P,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,v){S.__proto__=v}||function(S,v){for(var h in v)Object.prototype.hasOwnProperty.call(v,h)&&(S[h]=v[h])},c(P,r)};return function(P,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");c(P,r);function S(){this.constructor=P}P.prototype=r===null?Object.create(r):(S.prototype=r.prototype,new S)}}();Object.defineProperty(m,"__esModule",{value:!0}),m.CellHookData=m.HookData=void 0;var _=function(){function c(P,r,S){this.table=r,this.pageNumber=r.pageNumber,this.pageCount=this.pageNumber,this.settings=r.settings,this.cursor=S,this.doc=P.getDocument()}return c}();m.HookData=_;var w=function(c){C(P,c);function P(r,S,v,h,i,t){var e=c.call(this,r,S,t)||this;return e.cell=v,e.row=h,e.column=i,e.section=h.section,e}return P}(_);m.CellHookData=w},340:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0});var _=C(4),w=C(136),c=C(744),P=C(776),r=C(664),S=C(972);function v(h){h.API.autoTable=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];var e;i.length===1?e=i[0]:(console.error("Use of deprecated autoTable initiation"),e=i[2]||{},e.columns=i[0],e.body=i[1]);var l=(0,P.parseInput)(this,e),s=(0,S.createTable)(this,l);return(0,r.drawTable)(this,s),this},h.API.lastAutoTable=!1,h.API.previousAutoTable=!1,h.API.autoTable.previous=!1,h.API.autoTableText=function(i,t,e,l){(0,w.default)(i,t,e,l,this)},h.API.autoTableSetDefaults=function(i){return c.DocHandler.setDefaults(i,this),this},h.autoTableSetDefaults=function(i,t){c.DocHandler.setDefaults(i,t)},h.API.autoTableHtmlToJson=function(i,t){var e;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var l=new c.DocHandler(this),s=(0,_.parseHtml)(l,i,window,t,!1),n=s.head,f=s.body,p=((e=n[0])===null||e===void 0?void 0:e.map(function(y){return y.content}))||[];return{columns:p,rows:f,data:f}},h.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var i=this.lastAutoTable;return i&&i.finalY?i.finalY:0},h.API.autoTableAddPageContent=function(i){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),h.API.autoTable.globalDefaults||(h.API.autoTable.globalDefaults={}),h.API.autoTable.globalDefaults.addPageContent=i,this},h.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}m.default=v},136:function(A,m){Object.defineProperty(m,"__esModule",{value:!0});function C(_,w,c,P,r){P=P||{};var S=1.15,v=r.internal.scaleFactor,h=r.internal.getFontSize()/v,i=r.getLineHeightFactor?r.getLineHeightFactor():S,t=h*i,e=/\r\n|\r|\n/g,l="",s=1;if((P.valign==="middle"||P.valign==="bottom"||P.halign==="center"||P.halign==="right")&&(l=typeof _=="string"?_.split(e):_,s=l.length||1),c+=h*(2-S),P.valign==="middle"?c-=s/2*t:P.valign==="bottom"&&(c-=s*t),P.halign==="center"||P.halign==="right"){var n=h;if(P.halign==="center"&&(n*=.5),l&&s>=1){for(var f=0;f<l.length;f++)r.text(l[f],w-r.getStringUnitWidth(l[f])*n,c),c+=t;return r}w-=r.getStringUnitWidth(_)*n}return P.halign==="justify"?r.text(_,w,c,{maxWidth:P.maxWidth||100,align:"justify"}):r.text(_,w,c),r}m.default=C},420:function(A,m){Object.defineProperty(m,"__esModule",{value:!0}),m.getPageAvailableWidth=m.parseSpacing=m.getFillStyle=m.addTableBorder=m.getStringWidth=void 0;function C(r,S,v){v.applyStyles(S,!0);var h=Array.isArray(r)?r:[r],i=h.map(function(t){return v.getTextWidth(t)}).reduce(function(t,e){return Math.max(t,e)},0);return i}m.getStringWidth=C;function _(r,S,v,h){var i=S.settings.tableLineWidth,t=S.settings.tableLineColor;r.applyStyles({lineWidth:i,lineColor:t});var e=w(i,!1);e&&r.rect(v.x,v.y,S.getWidth(r.pageSize().width),h.y-v.y,e)}m.addTableBorder=_;function w(r,S){var v=r>0,h=S||S===0;return v&&h?"DF":v?"S":h?"F":null}m.getFillStyle=w;function c(r,S){var v,h,i,t;if(r=r||S,Array.isArray(r)){if(r.length>=4)return{top:r[0],right:r[1],bottom:r[2],left:r[3]};if(r.length===3)return{top:r[0],right:r[1],bottom:r[2],left:r[1]};if(r.length===2)return{top:r[0],right:r[1],bottom:r[0],left:r[1]};r.length===1?r=r[0]:r=S}return typeof r=="object"?(typeof r.vertical=="number"&&(r.top=r.vertical,r.bottom=r.vertical),typeof r.horizontal=="number"&&(r.right=r.horizontal,r.left=r.horizontal),{left:(v=r.left)!==null&&v!==void 0?v:S,top:(h=r.top)!==null&&h!==void 0?h:S,right:(i=r.right)!==null&&i!==void 0?i:S,bottom:(t=r.bottom)!==null&&t!==void 0?t:S}):(typeof r!="number"&&(r=S),{top:r,right:r,bottom:r,left:r})}m.parseSpacing=c;function P(r,S){var v=c(S.settings.margin,0);return r.pageSize().width-(v.left+v.right)}m.getPageAvailableWidth=P},796:function(A,m){var C=this&&this.__extends||function(){var P=function(r,S){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,h){v.__proto__=h}||function(v,h){for(var i in h)Object.prototype.hasOwnProperty.call(h,i)&&(v[i]=h[i])},P(r,S)};return function(r,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");P(r,S);function v(){this.constructor=r}r.prototype=S===null?Object.create(S):(v.prototype=S.prototype,new v)}}();Object.defineProperty(m,"__esModule",{value:!0}),m.getTheme=m.defaultStyles=m.HtmlRowInput=void 0;var _=function(P){C(r,P);function r(S){var v=P.call(this)||this;return v._element=S,v}return r}(Array);m.HtmlRowInput=_;function w(P){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/P,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}m.defaultStyles=w;function c(P){var r={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return r[P]}m.getTheme=c},903:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0}),m.parseCss=void 0;var _=C(420);function w(v,h,i,t,e){var l={},s=1.3333333333333333,n=P(h,function(d){return e.getComputedStyle(d).backgroundColor});n!=null&&(l.fillColor=n);var f=P(h,function(d){return e.getComputedStyle(d).color});f!=null&&(l.textColor=f);var p=S(t,i);p&&(l.cellPadding=p);var y="borderTopColor",g=s*i,o=t.borderTopWidth;if(t.borderBottomWidth===o&&t.borderRightWidth===o&&t.borderLeftWidth===o){var F=(parseFloat(o)||0)/g;F&&(l.lineWidth=F)}else l.lineWidth={top:(parseFloat(t.borderTopWidth)||0)/g,right:(parseFloat(t.borderRightWidth)||0)/g,bottom:(parseFloat(t.borderBottomWidth)||0)/g,left:(parseFloat(t.borderLeftWidth)||0)/g},l.lineWidth.top||(l.lineWidth.right?y="borderRightColor":l.lineWidth.bottom?y="borderBottomColor":l.lineWidth.left&&(y="borderLeftColor"));var x=P(h,function(d){return e.getComputedStyle(d)[y]});x!=null&&(l.lineColor=x);var M=["left","right","center","justify"];M.indexOf(t.textAlign)!==-1&&(l.halign=t.textAlign),M=["middle","bottom","top"],M.indexOf(t.verticalAlign)!==-1&&(l.valign=t.verticalAlign);var u=parseInt(t.fontSize||"");isNaN(u)||(l.fontSize=u/s);var a=c(t);a&&(l.fontStyle=a);var b=(t.fontFamily||"").toLowerCase();return v.indexOf(b)!==-1&&(l.font=b),l}m.parseCss=w;function c(v){var h="";return(v.fontWeight==="bold"||v.fontWeight==="bolder"||parseInt(v.fontWeight)>=700)&&(h="bold"),(v.fontStyle==="italic"||v.fontStyle==="oblique")&&(h+="italic"),h}function P(v,h){var i=r(v,h);if(!i)return null;var t=i.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!t||!Array.isArray(t))return null;var e=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])],l=parseInt(t[4]);return l===0||isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function r(v,h){var i=h(v);return i==="rgba(0, 0, 0, 0)"||i==="transparent"||i==="initial"||i==="inherit"?v.parentElement==null?null:r(v.parentElement,h):i}function S(v,h){var i=[v.paddingTop,v.paddingRight,v.paddingBottom,v.paddingLeft],t=96/(72/h),e=(parseInt(v.lineHeight)-parseInt(v.fontSize))/h/2,l=i.map(function(n){return parseInt(n||"0")/t}),s=(0,_.parseSpacing)(l,0);return e>s.top&&(s.top=e),e>s.bottom&&(s.bottom=e),s}},744:function(A,m){Object.defineProperty(m,"__esModule",{value:!0}),m.DocHandler=void 0;var C={},_=function(){function w(c){this.jsPDFDocument=c,this.userStyles={textColor:c.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:c.internal.getFontSize(),fontStyle:c.internal.getFont().fontStyle,font:c.internal.getFont().fontName,lineWidth:c.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:c.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return w.setDefaults=function(c,P){P===void 0&&(P=null),P?P.__autoTableDocumentDefaults=c:C=c},w.unifyColor=function(c){return Array.isArray(c)?c:typeof c=="number"?[c,c,c]:typeof c=="string"?[c]:null},w.prototype.applyStyles=function(c,P){var r,S,v;P===void 0&&(P=!1),c.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(c.fontStyle);var h=this.jsPDFDocument.internal.getFont(),i=h.fontStyle,t=h.fontName;if(c.font&&(t=c.font),c.fontStyle){i=c.fontStyle;var e=this.getFontList()[t];e&&e.indexOf(i)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e[0]),i=e[0])}if(this.jsPDFDocument.setFont(t,i),c.fontSize&&this.jsPDFDocument.setFontSize(c.fontSize),!P){var l=w.unifyColor(c.fillColor);l&&(r=this.jsPDFDocument).setFillColor.apply(r,l),l=w.unifyColor(c.textColor),l&&(S=this.jsPDFDocument).setTextColor.apply(S,l),l=w.unifyColor(c.lineColor),l&&(v=this.jsPDFDocument).setDrawColor.apply(v,l),typeof c.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(c.lineWidth)}},w.prototype.splitTextToSize=function(c,P,r){return this.jsPDFDocument.splitTextToSize(c,P,r)},w.prototype.rect=function(c,P,r,S,v){return this.jsPDFDocument.rect(c,P,r,S,v)},w.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},w.prototype.getTextWidth=function(c){return this.jsPDFDocument.getTextWidth(c)},w.prototype.getDocument=function(){return this.jsPDFDocument},w.prototype.setPage=function(c){this.jsPDFDocument.setPage(c)},w.prototype.addPage=function(){return this.jsPDFDocument.addPage()},w.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},w.prototype.getGlobalOptions=function(){return C||{}},w.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},w.prototype.pageSize=function(){var c=this.jsPDFDocument.internal.pageSize;return c.width==null&&(c={width:c.getWidth(),height:c.getHeight()}),c},w.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},w.prototype.getLineHeightFactor=function(){var c=this.jsPDFDocument;return c.getLineHeightFactor?c.getLineHeightFactor():1.15},w.prototype.getLineHeight=function(c){return c/this.scaleFactor()*this.getLineHeightFactor()},w.prototype.pageNumber=function(){var c=this.jsPDFDocument.internal.getCurrentPageInfo();return c?c.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},w}();m.DocHandler=_},4:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0}),m.parseHtml=void 0;var _=C(903),w=C(796);function c(S,v,h,i,t){var e,l;i===void 0&&(i=!1),t===void 0&&(t=!1);var s;typeof v=="string"?s=h.document.querySelector(v):s=v;var n=Object.keys(S.getFontList()),f=S.scaleFactor(),p=[],y=[],g=[];if(!s)return console.error("Html table could not be found with input: ",v),{head:p,body:y,foot:g};for(var o=0;o<s.rows.length;o++){var F=s.rows[o],x=(l=(e=F==null?void 0:F.parentElement)===null||e===void 0?void 0:e.tagName)===null||l===void 0?void 0:l.toLowerCase(),M=P(n,f,h,F,i,t);M&&(x==="thead"?p.push(M):x==="tfoot"?g.push(M):y.push(M))}return{head:p,body:y,foot:g}}m.parseHtml=c;function P(S,v,h,i,t,e){for(var l=new w.HtmlRowInput(i),s=0;s<i.cells.length;s++){var n=i.cells[s],f=h.getComputedStyle(n);if(t||f.display!=="none"){var p=void 0;e&&(p=(0,_.parseCss)(S,n,v,f,h)),l.push({rowSpan:n.rowSpan,colSpan:n.colSpan,styles:p,_element:n,content:r(n)})}}var y=h.getComputedStyle(i);if(l.length>0&&(t||y.display!=="none"))return l}function r(S){var v=S.cloneNode(!0);return v.innerHTML=v.innerHTML.replace(/\n/g,"").replace(/ +/g," "),v.innerHTML=v.innerHTML.split(/<br.*?>/).map(function(h){return h.trim()}).join(`
`),v.innerText||v.textContent||""}},776:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0}),m.parseInput=void 0;var _=C(4),w=C(356),c=C(420),P=C(744),r=C(792);function S(s,n){var f=new P.DocHandler(s),p=f.getDocumentOptions(),y=f.getGlobalOptions();(0,r.default)(f,y,p,n);var g=(0,w.assign)({},y,p,n),o;typeof window<"u"&&(o=window);var F=v(y,p,n),x=h(y,p,n),M=i(f,g),u=e(f,g,o);return{id:n.tableId,content:u,hooks:x,styles:F,settings:M}}m.parseInput=S;function v(s,n,f){for(var p={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},y=function(x){if(x==="columnStyles"){var M=s[x],u=n[x],a=f[x];p.columnStyles=(0,w.assign)({},M,u,a)}else{var b=[s,n,f],d=b.map(function(T){return T[x]||{}});p[x]=(0,w.assign)({},d[0],d[1],d[2])}},g=0,o=Object.keys(p);g<o.length;g++){var F=o[g];y(F)}return p}function h(s,n,f){for(var p=[s,n,f],y={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},g=0,o=p;g<o.length;g++){var F=o[g];F.didParseCell&&y.didParseCell.push(F.didParseCell),F.willDrawCell&&y.willDrawCell.push(F.willDrawCell),F.didDrawCell&&y.didDrawCell.push(F.didDrawCell),F.willDrawPage&&y.willDrawPage.push(F.willDrawPage),F.didDrawPage&&y.didDrawPage.push(F.didDrawPage)}return y}function i(s,n){var f,p,y,g,o,F,x,M,u,a,b,d,T=(0,c.parseSpacing)(n.margin,40/s.scaleFactor()),D=(f=t(s,n.startY))!==null&&f!==void 0?f:T.top,W;n.showFoot===!0?W="everyPage":n.showFoot===!1?W="never":W=(p=n.showFoot)!==null&&p!==void 0?p:"everyPage";var z;n.showHead===!0?z="everyPage":n.showHead===!1?z="never":z=(y=n.showHead)!==null&&y!==void 0?y:"everyPage";var j=(g=n.useCss)!==null&&g!==void 0?g:!1,R=n.theme||(j?"plain":"striped"),k=!!n.horizontalPageBreak,L=(o=n.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(F=n.includeHiddenHtml)!==null&&F!==void 0?F:!1,useCss:j,theme:R,startY:D,margin:T,pageBreak:(x=n.pageBreak)!==null&&x!==void 0?x:"auto",rowPageBreak:(M=n.rowPageBreak)!==null&&M!==void 0?M:"auto",tableWidth:(u=n.tableWidth)!==null&&u!==void 0?u:"auto",showHead:z,showFoot:W,tableLineWidth:(a=n.tableLineWidth)!==null&&a!==void 0?a:0,tableLineColor:(b=n.tableLineColor)!==null&&b!==void 0?b:200,horizontalPageBreak:k,horizontalPageBreakRepeat:L,horizontalPageBreakBehaviour:(d=n.horizontalPageBreakBehaviour)!==null&&d!==void 0?d:"afterAllRows"}}function t(s,n){var f=s.getLastAutoTable(),p=s.scaleFactor(),y=s.pageNumber(),g=!1;if(f&&f.startPageNumber){var o=f.startPageNumber+f.pageNumber-1;g=o===y}return typeof n=="number"?n:(n==null||n===!1)&&g&&(f==null?void 0:f.finalY)!=null?f.finalY+20/p:null}function e(s,n,f){var p=n.head||[],y=n.body||[],g=n.foot||[];if(n.html){var o=n.includeHiddenHtml;if(f){var F=(0,_.parseHtml)(s,n.html,f,o,n.useCss)||{};p=F.head||p,y=F.body||p,g=F.foot||p}else console.error("Cannot parse html in non browser environment")}var x=n.columns||l(p,y,g);return{columns:x,head:p,body:y,foot:g}}function l(s,n,f){var p=s[0]||n[0]||f[0]||[],y=[];return Object.keys(p).filter(function(g){return g!=="_element"}).forEach(function(g){var o=1,F;Array.isArray(p)?F=p[parseInt(g)]:F=p[g],typeof F=="object"&&!Array.isArray(F)&&(o=(F==null?void 0:F.colSpan)||1);for(var x=0;x<o;x++){var M=void 0;Array.isArray(p)?M=y.length:M=g+(x>0?"_".concat(x):"");var u={dataKey:M};y.push(u)}}),y}},792:function(A,m){Object.defineProperty(m,"__esModule",{value:!0});function C(w,c,P,r){for(var S=function(t){t&&typeof t!="object"&&console.error("The options parameter should be of type object, is: "+typeof t),typeof t.extendWidth<"u"&&(t.tableWidth=t.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof t.margins<"u"&&(typeof t.margin>"u"&&(t.margin=t.margins),console.error("Use of deprecated option: margins, use margin instead.")),t.startY&&typeof t.startY!="number"&&(console.error("Invalid value for startY option",t.startY),delete t.startY),!t.didDrawPage&&(t.afterPageContent||t.beforePageContent||t.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),t.didDrawPage=function(g){w.applyStyles(w.userStyles),t.beforePageContent&&t.beforePageContent(g),w.applyStyles(w.userStyles),t.afterPageContent&&t.afterPageContent(g),w.applyStyles(w.userStyles),t.afterPageAdd&&g.pageNumber>1&&g.afterPageAdd(g),w.applyStyles(w.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(g){t[g]&&console.error('The "'.concat(g,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(g){var o=g[0],F=g[1];t[F]&&(console.error("Use of deprecated option ".concat(F,". Use ").concat(o," instead")),t[o]=t[F])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(g){var o=typeof g=="string"?g:g[0],F=typeof g=="string"?g:g[1];typeof t[o]<"u"&&(typeof t.styles[F]>"u"&&(t.styles[F]=t[o]),console.error("Use of deprecated option: "+o+", use the style "+F+" instead."))});for(var e=0,l=["styles","bodyStyles","headStyles","footStyles"];e<l.length;e++){var s=l[e];_(t[s]||{})}for(var n=t.columnStyles||{},f=0,p=Object.keys(n);f<p.length;f++){var y=p[f];_(n[y]||{})}},v=0,h=[c,P,r];v<h.length;v++){var i=h[v];S(i)}}m.default=C;function _(w){w.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),w.minCellHeight||(w.minCellHeight=w.rowHeight)):w.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),w.cellWidth||(w.cellWidth=w.columnWidth))}},260:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0}),m.Column=m.Cell=m.Row=m.Table=void 0;var _=C(796),w=C(172),c=C(420),P=function(){function h(i,t){this.pageNumber=1,this.pageCount=1,this.id=i.id,this.settings=i.settings,this.styles=i.styles,this.hooks=i.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return h.prototype.getHeadHeight=function(i){return this.head.reduce(function(t,e){return t+e.getMaxCellHeight(i)},0)},h.prototype.getFootHeight=function(i){return this.foot.reduce(function(t,e){return t+e.getMaxCellHeight(i)},0)},h.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},h.prototype.callCellHooks=function(i,t,e,l,s,n){for(var f=0,p=t;f<p.length;f++){var y=p[f],g=new w.CellHookData(i,this,e,l,s,n),o=y(g)===!1;if(e.text=Array.isArray(e.text)?e.text:[e.text],o)return!1}return!0},h.prototype.callEndPageHooks=function(i,t){i.applyStyles(i.userStyles);for(var e=0,l=this.hooks.didDrawPage;e<l.length;e++){var s=l[e];s(new w.HookData(i,this,t))}},h.prototype.callWillDrawPageHooks=function(i,t){for(var e=0,l=this.hooks.willDrawPage;e<l.length;e++){var s=l[e];s(new w.HookData(i,this,t))}},h.prototype.getWidth=function(i){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(l,s){return l+s.wrappedWidth},0);return t}else{var e=this.settings.margin;return i-e.left-e.right}},h}();m.Table=P;var r=function(){function h(i,t,e,l,s){s===void 0&&(s=!1),this.height=0,this.raw=i,i instanceof _.HtmlRowInput&&(this.raw=i._element,this.element=i._element),this.index=t,this.section=e,this.cells=l,this.spansMultiplePages=s}return h.prototype.getMaxCellHeight=function(i){var t=this;return i.reduce(function(e,l){var s;return Math.max(e,((s=t.cells[l.index])===null||s===void 0?void 0:s.height)||0)},0)},h.prototype.hasRowSpan=function(i){var t=this;return i.filter(function(e){var l=t.cells[e.index];return l?l.rowSpan>1:!1}).length>0},h.prototype.canEntireRowFit=function(i,t){return this.getMaxCellHeight(t)<=i},h.prototype.getMinimumRowHeight=function(i,t){var e=this;return i.reduce(function(l,s){var n=e.cells[s.index];if(!n)return 0;var f=t.getLineHeight(n.styles.fontSize),p=n.padding("vertical"),y=p+f;return y>l?y:l},0)},h}();m.Row=r;var S=function(){function h(i,t,e){var l,s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=e,this.raw=i;var n=i;i!=null&&typeof i=="object"&&!Array.isArray(i)?(this.rowSpan=i.rowSpan||1,this.colSpan=i.colSpan||1,n=(s=(l=i.content)!==null&&l!==void 0?l:i.title)!==null&&s!==void 0?s:i,i._element&&(this.raw=i._element)):(this.rowSpan=1,this.colSpan=1);var f=n!=null?""+n:"",p=/\r\n|\r|\n/g;this.text=f.split(p)}return h.prototype.getTextPos=function(){var i;if(this.styles.valign==="top")i=this.y+this.padding("top");else if(this.styles.valign==="bottom")i=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");i=this.y+t/2+this.padding("top")}var e;if(this.styles.halign==="right")e=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var l=this.width-this.padding("horizontal");e=this.x+l/2+this.padding("left")}else e=this.x+this.padding("left");return{x:e,y:i}},h.prototype.getContentHeight=function(i,t){t===void 0&&(t=1.15);var e=Array.isArray(this.text)?this.text.length:1,l=this.styles.fontSize/i*t,s=e*l+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},h.prototype.padding=function(i){var t=(0,c.parseSpacing)(this.styles.cellPadding,0);return i==="vertical"?t.top+t.bottom:i==="horizontal"?t.left+t.right:t[i]},h}();m.Cell=S;var v=function(){function h(i,t,e){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=i,this.raw=t,this.index=e}return h.prototype.getMaxCustomCellWidth=function(i){for(var t=0,e=0,l=i.allRows();e<l.length;e++){var s=l[e],n=s.cells[this.index];n&&typeof n.styles.cellWidth=="number"&&(t=Math.max(t,n.styles.cellWidth))}return t},h}();m.Column=v},356:function(A,m){Object.defineProperty(m,"__esModule",{value:!0}),m.assign=void 0;function C(_,w,c,P,r){if(_==null)throw new TypeError("Cannot convert undefined or null to object");for(var S=Object(_),v=1;v<arguments.length;v++){var h=arguments[v];if(h!=null)for(var i in h)Object.prototype.hasOwnProperty.call(h,i)&&(S[i]=h[i])}return S}m.assign=C},972:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0}),m.createTable=void 0;var _=C(744),w=C(260),c=C(324),P=C(796),r=C(356);function S(s,n){var f=new _.DocHandler(s),p=v(n,f.scaleFactor()),y=new w.Table(n,p);return(0,c.calculateWidths)(f,y),f.applyStyles(f.userStyles),y}m.createTable=S;function v(s,n){var f=s.content,p=e(f.columns);if(f.head.length===0){var y=i(p,"head");y&&f.head.push(y)}if(f.foot.length===0){var y=i(p,"foot");y&&f.foot.push(y)}var g=s.settings.theme,o=s.styles;return{columns:p,head:h("head",f.head,p,o,g,n),body:h("body",f.body,p,o,g,n),foot:h("foot",f.foot,p,o,g,n)}}function h(s,n,f,p,y,g){var o={},F=n.map(function(x,M){for(var u=0,a={},b=0,d=0,T=0,D=f;T<D.length;T++){var W=D[T];if(o[W.index]==null||o[W.index].left===0)if(d===0){var z=void 0;Array.isArray(x)?z=x[W.index-b-u]:z=x[W.dataKey];var j={};typeof z=="object"&&!Array.isArray(z)&&(j=(z==null?void 0:z.styles)||{});var R=l(s,W,M,y,p,g,j),k=new w.Cell(z,R,s);a[W.dataKey]=k,a[W.index]=k,d=k.colSpan-1,o[W.index]={left:k.rowSpan-1,times:d}}else d--,b++;else o[W.index].left--,d=o[W.index].times,u++}return new w.Row(x,M,s,a)});return F}function i(s,n){var f={};return s.forEach(function(p){if(p.raw!=null){var y=t(n,p.raw);y!=null&&(f[p.dataKey]=y)}}),Object.keys(f).length>0?f:null}function t(s,n){if(s==="head"){if(typeof n=="object")return n.header||n.title||null;if(typeof n=="string"||typeof n=="number")return n}else if(s==="foot"&&typeof n=="object")return n.footer;return null}function e(s){return s.map(function(n,f){var p,y,g;return typeof n=="object"?g=(y=(p=n.dataKey)!==null&&p!==void 0?p:n.key)!==null&&y!==void 0?y:f:g=f,new w.Column(g,n,f)})}function l(s,n,f,p,y,g,o){var F=(0,P.getTheme)(p),x;s==="head"?x=y.headStyles:s==="body"?x=y.bodyStyles:s==="foot"&&(x=y.footStyles);var M=(0,r.assign)({},F.table,F[s],y.styles,x),u=y.columnStyles[n.dataKey]||y.columnStyles[n.index]||{},a=s==="body"?u:{},b=s==="body"&&f%2===0?(0,r.assign)({},F.alternateRow,y.alternateRowStyles):{},d=(0,P.defaultStyles)(g),T=(0,r.assign)({},d,M,b,a);return(0,r.assign)(T,o)}},664:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0}),m.addPage=m.drawTable=void 0;var _=C(420),w=C(260),c=C(744),P=C(356),r=C(136),S=C(224);function v(u,a){var b=a.settings,d=b.startY,T=b.margin,D={x:T.left,y:d},W=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns),z=d+T.bottom+W;if(b.pageBreak==="avoid"){var j=a.body,R=j.reduce(function(N,Y){return N+Y.height},0);z+=R}var k=new c.DocHandler(u);(b.pageBreak==="always"||b.startY!=null&&z>k.pageSize().height)&&(M(k),D.y=T.top),a.callWillDrawPageHooks(k,D);var L=(0,P.assign)({},D);a.startPageNumber=k.pageNumber(),b.horizontalPageBreak?h(k,a,L,D):(k.applyStyles(k.userStyles),(b.showHead==="firstPage"||b.showHead==="everyPage")&&a.head.forEach(function(N){return y(k,a,N,D,a.columns)}),k.applyStyles(k.userStyles),a.body.forEach(function(N,Y){var G=Y===a.body.length-1;p(k,a,N,G,L,D,a.columns)}),k.applyStyles(k.userStyles),(b.showFoot==="lastPage"||b.showFoot==="everyPage")&&a.foot.forEach(function(N){return y(k,a,N,D,a.columns)})),(0,_.addTableBorder)(k,a,L,D),a.callEndPageHooks(k,D),a.finalY=D.y,u.lastAutoTable=a,u.previousAutoTable=a,u.autoTable&&(u.autoTable.previous=a),k.applyStyles(k.userStyles)}m.drawTable=v;function h(u,a,b,d){var T=(0,S.calculateAllColumnsCanFitInPage)(u,a),D=a.settings;if(D.horizontalPageBreakBehaviour==="afterAllRows")T.forEach(function(R,k){u.applyStyles(u.userStyles),k>0?x(u,a,b,d,R.columns,!0):i(u,a,d,R.columns),t(u,a,b,d,R.columns),l(u,a,d,R.columns)});else for(var W=-1,z=T[0],j=function(){var R=W;if(z){u.applyStyles(u.userStyles);var k=z.columns;W>=0?x(u,a,b,d,k,!0):i(u,a,d,k),R=e(u,a,W+1,d,k),l(u,a,d,k)}var L=R-W;T.slice(1).forEach(function(N){u.applyStyles(u.userStyles),x(u,a,b,d,N.columns,!0),e(u,a,W+1,d,N.columns,L),l(u,a,d,N.columns)}),W=R};W<a.body.length-1;)j()}function i(u,a,b,d){var T=a.settings;u.applyStyles(u.userStyles),(T.showHead==="firstPage"||T.showHead==="everyPage")&&a.head.forEach(function(D){return y(u,a,D,b,d)})}function t(u,a,b,d,T){u.applyStyles(u.userStyles),a.body.forEach(function(D,W){var z=W===a.body.length-1;p(u,a,D,z,b,d,T)})}function e(u,a,b,d,T,D){u.applyStyles(u.userStyles),D=D??a.body.length;var W=Math.min(b+D,a.body.length),z=-1;return a.body.slice(b,W).forEach(function(j,R){var k=b+R===a.body.length-1,L=F(u,a,k,d);j.canEntireRowFit(L,T)&&(y(u,a,j,d,T),z=b+R)}),z}function l(u,a,b,d){var T=a.settings;u.applyStyles(u.userStyles),(T.showFoot==="lastPage"||T.showFoot==="everyPage")&&a.foot.forEach(function(D){return y(u,a,D,b,d)})}function s(u,a,b){var d=b.getLineHeight(u.styles.fontSize),T=u.padding("vertical"),D=Math.floor((a-T)/d);return Math.max(0,D)}function n(u,a,b,d){var T={};u.spansMultiplePages=!0,u.height=0;for(var D=0,W=0,z=b.columns;W<z.length;W++){var j=z[W],R=u.cells[j.index];if(R){Array.isArray(R.text)||(R.text=[R.text]);var k=new w.Cell(R.raw,R.styles,R.section);k=(0,P.assign)(k,R),k.text=[];var L=s(R,a,d);R.text.length>L&&(k.text=R.text.splice(L,R.text.length));var N=d.scaleFactor(),Y=d.getLineHeightFactor();R.contentHeight=R.getContentHeight(N,Y),R.contentHeight>=a&&(R.contentHeight=a,k.styles.minCellHeight-=a),R.contentHeight>u.height&&(u.height=R.contentHeight),k.contentHeight=k.getContentHeight(N,Y),k.contentHeight>D&&(D=k.contentHeight),T[j.index]=k}}var G=new w.Row(u.raw,-1,u.section,T,!0);G.height=D;for(var J=0,Q=b.columns;J<Q.length;J++){var j=Q[J],k=G.cells[j.index];k&&(k.height=G.height);var R=u.cells[j.index];R&&(R.height=u.height)}return G}function f(u,a,b,d){var T=u.pageSize().height,D=d.settings.margin,W=D.top+D.bottom,z=T-W;a.section==="body"&&(z-=d.getHeadHeight(d.columns)+d.getFootHeight(d.columns));var j=a.getMinimumRowHeight(d.columns,u),R=j<b;if(j>z)return console.error("Will not be able to print row ".concat(a.index," correctly since it's minimum height is larger than page height")),!0;if(!R)return!1;var k=a.hasRowSpan(d.columns),L=a.getMaxCellHeight(d.columns)>z;return L?(k&&console.error("The content of row ".concat(a.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(k||d.settings.rowPageBreak==="avoid")}function p(u,a,b,d,T,D,W){var z=F(u,a,d,D);if(b.canEntireRowFit(z,W))y(u,a,b,D,W);else if(f(u,b,z,a)){var j=n(b,z,a,u);y(u,a,b,D,W),x(u,a,T,D,W),p(u,a,j,d,T,D,W)}else x(u,a,T,D,W),p(u,a,b,d,T,D,W)}function y(u,a,b,d,T){d.x=a.settings.margin.left;for(var D=0,W=T;D<W.length;D++){var z=W[D],j=b.cells[z.index];if(!j){d.x+=z.width;continue}u.applyStyles(j.styles),j.x=d.x,j.y=d.y;var R=a.callCellHooks(u,a.hooks.willDrawCell,j,b,z,d);if(R===!1){d.x+=z.width;continue}g(u,j,d);var k=j.getTextPos();(0,r.default)(j.text,k.x,k.y,{halign:j.styles.halign,valign:j.styles.valign,maxWidth:Math.ceil(j.width-j.padding("left")-j.padding("right"))},u.getDocument()),a.callCellHooks(u,a.hooks.didDrawCell,j,b,z,d),d.x+=z.width}d.y+=b.height}function g(u,a,b){var d=a.styles;if(u.getDocument().setFillColor(u.getDocument().getFillColor()),typeof d.lineWidth=="number"){var T=(0,_.getFillStyle)(d.lineWidth,d.fillColor);T&&u.rect(a.x,b.y,a.width,a.height,T)}else typeof d.lineWidth=="object"&&(d.fillColor&&u.rect(a.x,b.y,a.width,a.height,"F"),o(u,a,b,d.lineWidth))}function o(u,a,b,d){var T,D,W,z;d.top&&(T=b.x,D=b.y,W=b.x+a.width,z=b.y,d.right&&(W+=.5*d.right),d.left&&(T-=.5*d.left),j(d.top,T,D,W,z)),d.bottom&&(T=b.x,D=b.y+a.height,W=b.x+a.width,z=b.y+a.height,d.right&&(W+=.5*d.right),d.left&&(T-=.5*d.left),j(d.bottom,T,D,W,z)),d.left&&(T=b.x,D=b.y,W=b.x,z=b.y+a.height,d.top&&(D-=.5*d.top),d.bottom&&(z+=.5*d.bottom),j(d.left,T,D,W,z)),d.right&&(T=b.x+a.width,D=b.y,W=b.x+a.width,z=b.y+a.height,d.top&&(D-=.5*d.top),d.bottom&&(z+=.5*d.bottom),j(d.right,T,D,W,z));function j(R,k,L,N,Y){u.getDocument().setLineWidth(R),u.getDocument().line(k,L,N,Y,"S")}}function F(u,a,b,d){var T=a.settings.margin.bottom,D=a.settings.showFoot;return(D==="everyPage"||D==="lastPage"&&b)&&(T+=a.getFootHeight(a.columns)),u.pageSize().height-d.y-T}function x(u,a,b,d,T,D){T===void 0&&(T=[]),D===void 0&&(D=!1),u.applyStyles(u.userStyles),a.settings.showFoot==="everyPage"&&!D&&a.foot.forEach(function(z){return y(u,a,z,d,T)}),a.callEndPageHooks(u,d);var W=a.settings.margin;(0,_.addTableBorder)(u,a,b,d),M(u),a.pageNumber++,a.pageCount++,d.x=W.left,d.y=W.top,b.y=W.top,a.callWillDrawPageHooks(u,d),a.settings.showHead==="everyPage"&&(a.head.forEach(function(z){return y(u,a,z,d,T)}),u.applyStyles(u.userStyles))}m.addPage=x;function M(u){var a=u.pageNumber();u.setPage(a+1);var b=u.pageNumber();return b===a?(u.addPage(),!0):!1}},224:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0}),m.calculateAllColumnsCanFitInPage=void 0;var _=C(420);function w(P,r,S){var v;S===void 0&&(S={});var h=(0,_.getPageAvailableWidth)(P,r),i=new Map,t=[],e=[],l=[];r.settings.horizontalPageBreakRepeat,Array.isArray(r.settings.horizontalPageBreakRepeat)?l=r.settings.horizontalPageBreakRepeat:(typeof r.settings.horizontalPageBreakRepeat=="string"||typeof r.settings.horizontalPageBreakRepeat=="number")&&(l=[r.settings.horizontalPageBreakRepeat]),l.forEach(function(p){var y=r.columns.find(function(g){return g.dataKey===p||g.index===p});y&&!i.has(y.index)&&(i.set(y.index,!0),t.push(y.index),e.push(r.columns[y.index]),h-=y.wrappedWidth)});for(var s=!0,n=(v=S==null?void 0:S.start)!==null&&v!==void 0?v:0;n<r.columns.length;){if(i.has(n)){n++;continue}var f=r.columns[n].wrappedWidth;if(s||h>=f)s=!1,t.push(n),e.push(r.columns[n]),h-=f;else break;n++}return{colIndexes:t,columns:e,lastIndex:n-1}}function c(P,r){for(var S=[],v=0;v<r.columns.length;v++){var h=w(P,r,{start:v});h.columns.length&&(S.push(h),v=h.lastIndex)}return S}m.calculateAllColumnsCanFitInPage=c},324:function(A,m,C){Object.defineProperty(m,"__esModule",{value:!0}),m.ellipsize=m.resizeColumns=m.calculateWidths=void 0;var _=C(420);function w(t,e){c(t,e);var l=[],s=0;e.columns.forEach(function(f){var p=f.getMaxCustomCellWidth(e);p?f.width=p:(f.width=f.wrappedWidth,l.push(f)),s+=f.width});var n=e.getWidth(t.pageSize().width)-s;n&&(n=P(l,n,function(f){return Math.max(f.minReadableWidth,f.minWidth)})),n&&(n=P(l,n,function(f){return f.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),S(e),v(e,t),r(e)}m.calculateWidths=w;function c(t,e){var l=t.scaleFactor(),s=e.settings.horizontalPageBreak,n=(0,_.getPageAvailableWidth)(t,e);e.allRows().forEach(function(f){for(var p=0,y=e.columns;p<y.length;p++){var g=y[p],o=f.cells[g.index];if(o){var F=e.hooks.didParseCell;e.callCellHooks(t,F,o,f,g,null);var x=o.padding("horizontal");o.contentWidth=(0,_.getStringWidth)(o.text,o.styles,t)+x;var M=(0,_.getStringWidth)(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,t);if(o.minReadableWidth=M+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||s===!0)o.contentWidth>n?(o.minWidth=n,o.wrappedWidth=n):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var u=10/l;o.minWidth=o.styles.minCellWidth||u,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),e.allRows().forEach(function(f){for(var p=0,y=e.columns;p<y.length;p++){var g=y[p],o=f.cells[g.index];if(o&&o.colSpan===1)g.wrappedWidth=Math.max(g.wrappedWidth,o.wrappedWidth),g.minWidth=Math.max(g.minWidth,o.minWidth),g.minReadableWidth=Math.max(g.minReadableWidth,o.minReadableWidth);else{var F=e.styles.columnStyles[g.dataKey]||e.styles.columnStyles[g.index]||{},x=F.cellWidth||F.minCellWidth;x&&typeof x=="number"&&(g.minWidth=x,g.wrappedWidth=x)}o&&(o.colSpan>1&&!g.minWidth&&(g.minWidth=o.minWidth),o.colSpan>1&&!g.wrappedWidth&&(g.wrappedWidth=o.minWidth))}})}function P(t,e,l){for(var s=e,n=t.reduce(function(u,a){return u+a.wrappedWidth},0),f=0;f<t.length;f++){var p=t[f],y=p.wrappedWidth/n,g=s*y,o=p.width+g,F=l(p),x=o<F?F:o;e-=x-p.width,p.width=x}if(e=Math.round(e*1e10)/1e10,e){var M=t.filter(function(u){return e<0?u.width>l(u):!0});M.length&&(e=P(M,e,l))}return e}m.resizeColumns=P;function r(t){for(var e={},l=1,s=t.allRows(),n=0;n<s.length;n++)for(var f=s[n],p=0,y=t.columns;p<y.length;p++){var g=y[p],o=e[g.index];if(l>1)l--,delete f.cells[g.index];else if(o)o.cell.height+=f.height,l=o.cell.colSpan,delete f.cells[g.index],o.left--,o.left<=1&&delete e[g.index];else{var F=f.cells[g.index];if(!F)continue;if(F.height=f.height,F.rowSpan>1){var x=s.length-n,M=F.rowSpan>x?x:F.rowSpan;e[g.index]={cell:F,left:M,row:f}}}}}function S(t){for(var e=t.allRows(),l=0;l<e.length;l++)for(var s=e[l],n=null,f=0,p=0,y=0;y<t.columns.length;y++){var g=t.columns[y];if(p-=1,p>1&&t.columns[y+1])f+=g.width,delete s.cells[g.index];else if(n){var o=n;delete s.cells[g.index],n=null,o.width=g.width+f}else{var o=s.cells[g.index];if(!o)continue;if(p=o.colSpan,f=0,o.colSpan>1){n=o,f+=g.width;continue}o.width=g.width+f}}}function v(t,e){for(var l={count:0,height:0},s=0,n=t.allRows();s<n.length;s++){for(var f=n[s],p=0,y=t.columns;p<y.length;p++){var g=y[p],o=f.cells[g.index];if(o){e.applyStyles(o.styles,!0);var F=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=e.splitTextToSize(o.text,F+1/e.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=h(o.text,F,o.styles,e,"...");else if(o.styles.overflow==="hidden")o.text=h(o.text,F,o.styles,e,"");else if(typeof o.styles.overflow=="function"){var x=o.styles.overflow(o.text,F);typeof x=="string"?o.text=[x]:o.text=x}o.contentHeight=o.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var M=o.contentHeight/o.rowSpan;o.rowSpan>1&&l.count*l.height<M*o.rowSpan?l={height:M,count:o.rowSpan}:l&&l.count>0&&l.height>M&&(M=l.height),M>f.height&&(f.height=M)}}l.count--}}function h(t,e,l,s,n){return t.map(function(f){return i(f,e,l,s,n)})}m.ellipsize=h;function i(t,e,l,s,n){var f=1e4*s.scaleFactor();if(e=Math.ceil(e*f)/f,e>=(0,_.getStringWidth)(t,l,s))return t;for(;e<(0,_.getStringWidth)(t+n,l,s)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}},964:function(A){if(typeof B>"u"){var m=new Error("Cannot find module 'undefined'");throw m.code="MODULE_NOT_FOUND",m}A.exports=B}},I={};function E(A){var m=I[A];if(m!==void 0)return m.exports;var C=I[A]={exports:{}};return H[A].call(C.exports,C,C.exports,E),C.exports}var U={};return function(){var A=U;Object.defineProperty(A,"__esModule",{value:!0}),A.Cell=A.Column=A.Row=A.Table=A.CellHookData=A.__drawTable=A.__createTable=A.applyPlugin=void 0;var m=E(340),C=E(776),_=E(664),w=E(972),c=E(260);Object.defineProperty(A,"Table",{enumerable:!0,get:function(){return c.Table}});var P=E(172);Object.defineProperty(A,"CellHookData",{enumerable:!0,get:function(){return P.CellHookData}});var r=E(260);Object.defineProperty(A,"Cell",{enumerable:!0,get:function(){return r.Cell}}),Object.defineProperty(A,"Column",{enumerable:!0,get:function(){return r.Column}}),Object.defineProperty(A,"Row",{enumerable:!0,get:function(){return r.Row}});function S(e){(0,m.default)(e)}A.applyPlugin=S;function v(e,l){var s=(0,C.parseInput)(e,l),n=(0,w.createTable)(e,s);(0,_.drawTable)(e,n)}function h(e,l){var s=(0,C.parseInput)(e,l);return(0,w.createTable)(e,s)}A.__createTable=h;function i(e,l){(0,_.drawTable)(e,l)}A.__drawTable=i;try{var t=E(964);t.jsPDF&&(t=t.jsPDF),S(t)}catch{}A.default=v}(),U}()})})(nt);const it=O=>({EUR:"€",USD:"$",CHF:"CHF"})[O]||O,V=()=>{const O=new tt;return O.setFont("Helvetica","normal"),O},st=(O,$,B)=>{const H=V(),I=it(O.currency),E=r=>{if(B.logoUrl)try{const v=B.logoUrl.split(".").pop().toUpperCase();["PNG","JPG","JPEG"].includes(v)?r.addImage(B.logoUrl,v,15,15,40,15):r.setFontSize(20).setFont("Helvetica","bold").text(B.name,15,25)}catch(v){console.error("Error adding logo:",v),r.setFontSize(20).setFont("Helvetica","bold").text(B.name,15,25)}else r.setFontSize(20).setFont("Helvetica","bold").text(B.name,15,25);r.setFontSize(8).setFont("Helvetica","normal");const S=`${B.street}, ${B.zip} ${B.city}`;r.text(S,195,20,{align:"right"})};E(H),H.setFontSize(10),H.text("An:",15,50),H.setFont("Helvetica","bold"),H.text(`${$.firstName} ${$.lastName}`,15,55),H.setFont("Helvetica","normal");const U=$.address?$.address.split(", "):["Keine Adresse",""];H.text(U[0],15,60),U[1]&&H.text(U[1],15,65),H.setFontSize(10),H.text("Rechnungs-Nr.:",140,50),H.text("Datum:",140,57),H.text("Fällig am:",140,64),H.setFont("Helvetica","bold"),H.text(O.invoiceNumber,195,50,{align:"right"}),H.setFont("Helvetica","normal"),H.text(K(new Date(O.date),"dd.MM.yyyy"),195,57,{align:"right"}),H.text(K(new Date(O.dueDate),"dd.MM.yyyy"),195,64,{align:"right"}),H.setFontSize(14).setFont("Helvetica","bold"),H.text(`Rechnung für ${O.title||"Coaching & Beratung"}`,15,85);const A=["#","Beschreibung","Menge","Einzelpreis","Gesamt"],m=[];O.items.forEach((r,S)=>{m.push([S+1,r.description,r.quantity,`${r.price.toFixed(2)} ${I}`,`${(r.quantity*r.price).toFixed(2)} ${I}`])}),H.autoTable({startY:95,head:[A],body:m,theme:"striped",headStyles:{fillColor:[38,43,54],font:"Helvetica",fontStyle:"bold"},bodyStyles:{font:"Helvetica"},didDrawPage:r=>{r.pageNumber>1&&E(H)}});const C=H.lastAutoTable.finalY+10;H.setFontSize(10),H.text("Zwischensumme:",140,C),H.text(`${O.subtotal.toFixed(2)} ${I}`,195,C,{align:"right"}),H.text(`Umsatzsteuer (${O.taxRate}%):`,140,C+7),H.text(`${O.taxAmount.toFixed(2)} ${I}`,195,C+7,{align:"right"}),H.setLineWidth(.2).line(140,C+12,195,C+12),H.setFontSize(12).setFont("Helvetica","bold"),H.text("Gesamtbetrag:",140,C+18),H.text(`${O.total.toFixed(2)} ${I}`,195,C+18,{align:"right"});const _=B.paymentDeadlineDays||14;H.setFontSize(10).setFont("Helvetica","normal"),H.text(`Bitte überweisen Sie den Betrag innerhalb von ${_} Tagen.`,15,H.internal.pageSize.height-50);const w=H.internal.pageSize.height-30;H.setLineWidth(.1).line(15,w,195,w),H.setFontSize(8);let c=`${B.name} | Inhaber: ${B.owner}`;B.showBankDetailsOnInvoice&&(c+=` | ${B.bankName} | IBAN: ${B.iban}`),H.text(c,H.internal.pageSize.getWidth()/2,w+5,{align:"center"});let P=`Tel: ${B.phone} | E-Mail: ${B.email} | Web: ${B.website}`;H.text(P,H.internal.pageSize.getWidth()/2,w+10,{align:"center"}),H.save(`Rechnung-${O.invoiceNumber}.pdf`)},ft=(O,$,B)=>{const H=V();H.setFont("Helvetica","bold"),H.setFontSize(20),H.text("Sitzungsnotiz",14,22),H.setFontSize(11),H.setFont("Helvetica","normal");const I=[["Titel:",O.title],["Coachee:",$?`${$.firstName} ${$.lastName}`:"N/A"],["Session:",B?`${B.topic} am ${K(new Date(B.date),"dd.MM.yyyy",{locale:X})}`:"Keine spezifische Session"],["Erstellt am:",K(new Date(O.createdAt),"dd. MMMM yyyy, HH:mm",{locale:X})+" Uhr"]];H.autoTable({body:I,startY:30,theme:"plain",styles:{cellPadding:1.5,fontSize:11,font:"Helvetica"},columnStyles:{0:{fontStyle:"bold",cellWidth:35}}}),H.setFontSize(12),H.setFont("Helvetica","bold");const E=H.lastAutoTable.finalY;H.text("Inhalt der Notiz",14,E+15);const U=H.splitTextToSize(O.content,180);let A=E+22;H.setFont("Helvetica","normal"),H.setFontSize(11),U.forEach(C=>{A>280&&(H.addPage(),A=20),C.startsWith("## ")?(H.setFont("Helvetica","bold"),H.setFontSize(14),H.text(C.substring(3),14,A),H.setFont("Helvetica","normal"),H.setFontSize(11)):C.startsWith("- ")?(H.text("•",14,A),H.text(C.substring(2),18,A)):H.text(C,14,A),A+=7});const m=H.internal.getNumberOfPages();for(let C=1;C<=m;C++)H.setPage(C),H.setFontSize(9),H.setTextColor(150),H.text(`Seite ${C} von ${m}`,H.internal.pageSize.width-25,290);H.save(`Sitzungsnotiz_${O.id}_${$?$.lastName:""}.pdf`)};export{ft as a,st as g};
